module.exports=[86147,a=>{"use strict";var b=a.i(87924),c=a.i(52507),d=a.i(86762),e=a.i(6747),f=a.i(15009),g=a.i(98275),h=a.i(36595),i=a.i(43588),j=a.i(13445),k=a.i(17600),l=a.i(72131),m=a.i(33210),n=a.i(53343),o=a.i(4197),p=a.i(54708),q=a.i(61240);function r(){let{token:a,user:i}=(0,q.useAuth)(),[k,r]=(0,l.useState)(!0),[t,u]=(0,l.useState)([]),[v,w]=(0,l.useState)(!1),[x,y]=(0,l.useState)(null),[z,A]=(0,l.useState)(!1),[B,C]=(0,l.useState)(null),[D,E]=(0,l.useState)(0),[F,G]=(0,l.useState)({title:"",description:"",priceType:"fixed",price:void 0,delivery:"",includes:[],cta:"request",visible:!0});(0,l.useEffect)(()=>{let b=!0;return(async()=>{try{if(!i?.id||!a)return;let c=await p.api.get(`/users/id/${i.id}/offers`,{token:a});if(!b)return;u((c.data?.offers||[]).map(a=>({id:String(a._id||a.id),title:a.title,description:a.description,price:"number"==typeof a.price?a.price:0,priceType:a.priceType,visible:a.visible,includes:a.includes||[],cta:a.cta||void 0,delivery:a.delivery||void 0})))}catch{}finally{r(!1)}})(),()=>{b=!1}},[i?.id,a]);let H=()=>{y(null),G({title:"",description:"",priceType:"fixed",price:void 0,delivery:"",includes:[],cta:"request",visible:!0}),w(!0)},I=async()=>{if(!F.title.trim())return;let b={title:F.title.trim(),description:F.description.slice(0,120),priceType:F.priceType,price:"custom"===F.priceType?null:Math.max(0,Number(F.price||0)),includes:F.includes,cta:F.cta,delivery:F.delivery||"",visible:F.visible,currency:"INR"};try{if(!i?.id||!a)throw Error("unauthorized");if(null===x){let c=(await p.api.post(`/users/id/${i.id}/offers`,b,{token:a})).data.offer,d={id:String(c._id||c.id),title:c.title,description:c.description,price:"number"==typeof c.price?c.price:0,priceType:c.priceType,visible:c.visible,includes:c.includes||[],cta:c.cta||void 0,delivery:c.delivery||void 0};u(a=>[d,...a]),E(a=>a+1)}else{let c=t[x].id,d=(await p.api.patch(`/users/id/${i.id}/offers/${c}`,b,{token:a})).data.offer,e={id:String(d._id||d.id),title:d.title,description:d.description,price:"number"==typeof d.price?d.price:0,priceType:d.priceType,visible:d.visible,includes:d.includes||[],cta:d.cta||void 0,delivery:d.delivery||void 0};u(a=>a.map((a,b)=>b===x?e:a)),E(a=>a+1)}}catch{}finally{w(!1)}};return(0,b.jsxs)("section",{className:"flex min-h-screen flex-col lg:pl-[300px]",children:[(0,b.jsx)("div",{className:" top-0 z-10 px-4 md:px-8 pt-6 pb-4",children:(0,b.jsx)("div",{className:"w-full max-w-8xl",children:(0,b.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-3",children:[(0,b.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,b.jsx)("h1",{className:"text-display-sm font-semibold text-primary",children:"My Offerings"}),(0,b.jsx)("p",{className:"text-md text-tertiary",children:"Services visible on your public profile"})]}),(0,b.jsx)("div",{className:"mt-3 md:mt-0",children:(0,b.jsx)(c.Button,{className:"w-full md:w-auto",size:"sm",onClick:H,children:"+ Add Offer"})})]})})}),(0,b.jsx)("div",{className:"flex-1 min-h-0 overflow-y-auto overscroll-contain px-4 md:px-8 pt-8 pb-12",children:(0,b.jsxs)("div",{className:"w-full max-w-8xl grid gap-8 lg:grid-cols-[1fr_1px_360px]",children:[(0,b.jsx)("div",{className:"flex flex-col gap-6",children:k?(0,b.jsx)("div",{className:"grid grid-cols-1 gap-3",children:[void 0,void 0,void 0,void 0].map((a,c)=>(0,b.jsxs)("div",{className:"rounded-2xl bg-primary p-4 md:p-5 shadow-xs ring-1 ring-secondary_alt",children:[(0,b.jsx)("div",{className:"h-5 w-40 bg-primary_hover animate-pulse rounded"}),(0,b.jsx)("div",{className:"mt-2 h-3 w-64 bg-primary_hover animate-pulse rounded"}),(0,b.jsxs)("div",{className:"mt-4 grid grid-cols-2 gap-2",children:[(0,b.jsx)("div",{className:"h-3 bg-primary_hover animate-pulse rounded"}),(0,b.jsx)("div",{className:"h-3 bg-primary_hover animate-pulse rounded"})]})]},c))}):(0,b.jsx)(s,{offers:t,setOffers:u,onEdit:a=>{let b=t[a];y(a),G({title:b.title,description:b.description,priceType:b.priceType,price:"custom"!==b.priceType?b.price:void 0,delivery:b.delivery||"",includes:b.includes||[],cta:b.cta||"request",visible:b.visible}),w(!0)},onAdd:H,onDelete:a=>{C(a),A(!0)},onReorder:async b=>{u(b);try{if(!i?.id||!a)return;await Promise.all(b.map((b,c)=>p.api.patch(`/users/id/${i.id}/offers/${b.id}`,{order:c+1},{token:a}))),E(a=>a+1)}catch{}},onToggle:async(b,c)=>{u(a=>a.map((a,d)=>d===b?{...a,visible:c}:a));try{if(!i?.id||!a)return;let d=t[b].id;await p.api.patch(`/users/id/${i.id}/offers/${d}`,{visible:c},{token:a}),E(a=>a+1)}catch{}}})}),(0,b.jsx)("div",{"aria-hidden":!0,className:"hidden lg:block self-stretch w-px bg-border-secondary"}),(0,b.jsx)("div",{className:"hidden lg:block",children:(0,b.jsx)("div",{className:"lg:sticky top-6",children:(0,b.jsx)(l.Suspense,{fallback:null,children:(0,b.jsx)(o.PhonePreview,{username:i?.username?`${i.username}?v=${D}`:void 0})})})})]})}),(0,b.jsxs)(m.DialogTrigger,{isOpen:z,onOpenChange:A,children:[(0,b.jsx)(c.Button,{slot:"trigger",className:"hidden",children:"Open"}),(0,b.jsx)(n.ModalOverlay,{isDismissable:!0,className:({isEntering:a,isExiting:b})=>`fixed inset-0 z-50 bg-overlay/40 backdrop-blur-sm ${a?"duration-150 ease-out animate-in fade-in":""} ${b?"duration-100 ease-in animate-out fade-out":""}`,children:({state:d})=>(0,b.jsx)(n.Modal,{className:"w-full h-dvh cursor-auto flex items-center justify-center p-4",children:(0,b.jsxs)(m.Dialog,{className:"w-full max-w-sm overflow-hidden rounded-2xl bg-primary shadow-xl ring-1 ring-secondary_alt focus:outline-hidden",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between border-b border-secondary px-4 py-3",children:[(0,b.jsx)("h2",{className:"text-lg font-semibold text-primary",children:"Delete offer?"}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(c.Button,{size:"sm",color:"secondary",onClick:async()=>{if(null!==B)try{if(!i?.id||!a)throw Error("unauthorized");let b=t[B].id;await p.api.delete(`/users/id/${i.id}/offers/${b}`,{token:a}),u(a=>a.filter((a,b)=>b!==B)),E(a=>a+1)}catch{}finally{C(null),d.close()}},children:"Delete"}),(0,b.jsx)(c.Button,{size:"sm",onClick:()=>d.close(),children:"Cancel"})]})]}),(0,b.jsx)("div",{className:"px-4 py-4",children:(0,b.jsx)("p",{className:"text-sm text-tertiary",children:"This removes it from your profile immediately."})})]})})})]}),(0,b.jsxs)(m.DialogTrigger,{isOpen:v,onOpenChange:w,children:[(0,b.jsx)(c.Button,{slot:"trigger",className:"hidden",children:"Open"}),(0,b.jsx)(n.ModalOverlay,{isDismissable:!0,className:({isEntering:a,isExiting:b})=>`fixed inset-0 z-50 bg-overlay/40 backdrop-blur-sm ${a?"duration-150 ease-out animate-in fade-in":""} ${b?"duration-100 ease-in animate-out fade-out":""}`,children:({state:a})=>(0,b.jsx)(n.Modal,{className:"w-full cursor-auto",children:(0,b.jsxs)(m.Dialog,{className:"ml-auto h-dvh w-full max-w-md overflow-y-auto rounded-none bg-primary shadow-xl ring-1 ring-secondary_alt focus:outline-hidden",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between border-b border-secondary px-4 py-3",children:[(0,b.jsx)("h2",{className:"text-lg font-semibold text-primary",children:null===x?"Add Offer":"Edit Offer"}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(c.Button,{size:"sm",color:"secondary",onClick:I,children:"Save"}),(0,b.jsx)(c.Button,{size:"sm",onClick:()=>a.close(),children:"Cancel"})]})]}),(0,b.jsxs)("div",{className:"flex flex-col gap-6 px-4 py-4",children:[(0,b.jsxs)("div",{className:"flex min-w-0 flex-col gap-2",children:[(0,b.jsx)("h3",{className:"text-md font-semibold text-primary",children:"Basic Info"}),(0,b.jsx)(f.Input,{label:"Offer title",placeholder:"e.g. Instagram Reel Promotion",value:F.title,onChange:a=>G(b=>({...b,title:a}))}),(0,b.jsx)(g.TextArea,{label:"Short description",rows:3,value:F.description,onChange:a=>G(b=>({...b,description:a.slice(0,120)})),hint:`${Math.min(120,F.description.length)}/120`})]}),(0,b.jsxs)("div",{className:"flex min-w-0 flex-col gap-2",children:[(0,b.jsx)("h3",{className:"text-md font-semibold text-primary",children:"Pricing"}),(0,b.jsx)(h.Select,{size:"md",label:"Price type",items:[{id:"fixed",label:"Fixed price"},{id:"starting",label:"Starting from"},{id:"custom",label:"Custom quote"}],selectedKey:F.priceType,onSelectionChange:a=>G(b=>({...b,priceType:String(a)})),children:a=>(0,b.jsx)(h.Select.Item,{id:a.id,children:a.label})}),"custom"!==F.priceType&&(0,b.jsx)(f.Input,{label:"Amount (₹)",type:"number",inputMode:"numeric",placeholder:"0",value:String(F.price??""),onChange:a=>G(b=>({...b,price:Number(a||0)}))}),(0,b.jsx)(f.Input,{label:"Delivery time (optional)",placeholder:"e.g. 5 days",value:F.delivery||"",onChange:a=>G(b=>({...b,delivery:a}))})]}),(0,b.jsxs)("div",{className:"flex min-w-0 flex-col gap-2",children:[(0,b.jsx)("h3",{className:"text-md font-semibold text-primary",children:"What’s Included"}),(0,b.jsx)("ul",{className:"flex flex-col gap-2",children:(F.includes||[]).map((a,c)=>(0,b.jsxs)("li",{className:"flex items-center gap-2",children:[(0,b.jsx)(f.Input,{className:"flex-1",placeholder:"e.g. 1 Instagram Reel",value:a,onChange:a=>G(b=>({...b,includes:b.includes.map((b,d)=>d===c?a:b)}))}),(0,b.jsx)(d.ButtonUtility,{"aria-label":"Remove",icon:j.Trash01,size:"sm",onClick:()=>G(a=>({...a,includes:a.includes.filter((a,b)=>b!==c)}))})]},c))}),(0,b.jsx)("div",{children:(0,b.jsx)(c.Button,{size:"sm",color:"secondary",onClick:()=>G(a=>({...a,includes:[...a.includes||[],""]})),children:"Add row"})})]}),(0,b.jsxs)("div",{className:"flex min-w-0 flex-col gap-2",children:[(0,b.jsx)("h3",{className:"text-md font-semibold text-primary",children:"CTA Behavior"}),(0,b.jsx)(h.Select,{size:"md",label:"What happens when brand clicks",items:[{id:"request",label:"Request service"},{id:"pay",label:"Pay now"},{id:"request_pay_later",label:"Request + Pay later"}],selectedKey:F.cta,onSelectionChange:a=>G(b=>({...b,cta:String(a)})),children:a=>(0,b.jsx)(h.Select.Item,{id:a.id,children:a.label})})]}),(0,b.jsxs)("div",{className:"flex min-w-0 flex-col gap-2",children:[(0,b.jsx)("h3",{className:"text-md font-semibold text-primary",children:"Visibility"}),(0,b.jsx)(e.Toggle,{slim:!0,size:"md",isSelected:F.visible,onChange:a=>G(b=>({...b,visible:a})),"aria-label":"Show on profile"})]})]})]})})})]})]})}let s=({offers:a,setOffers:f,onEdit:g,onAdd:h,onDelete:m,onReorder:n,onToggle:o})=>{let[p,q]=(0,l.useState)(null),r=(0,l.useMemo)(()=>new Intl.NumberFormat("en-IN"),[]);return 0===a.length?(0,b.jsx)("div",{className:"rounded-2xl bg-primary p-6 shadow-xs ring-1 ring-secondary_alt",children:(0,b.jsxs)("div",{className:"mx-auto max-w-md text-center",children:[(0,b.jsx)("h3",{className:"text-md font-semibold text-primary",children:"Add your first service"}),(0,b.jsx)("p",{className:"mt-1 text-sm text-tertiary",children:"Brands contact creators faster when pricing is clear."}),(0,b.jsx)("div",{className:"mt-4",children:(0,b.jsx)(c.Button,{size:"sm",color:"secondary",onClick:h,children:"+ Add Offer"})})]})}):(0,b.jsx)("div",{className:"rounded-2xl bg-primary p-4 md:p-5 shadow-xs ring-1 ring-secondary_alt",children:(0,b.jsx)("div",{className:"flex min-w-0 flex-col",children:(0,b.jsx)("ul",{className:"flex flex-col gap-2",children:a.map((c,f)=>(0,b.jsxs)("li",{draggable:!0,onDragStart:()=>q(f),onDragOver:a=>a.preventDefault(),onDrop:async()=>{if(null===p||p===f)return;let b=[...a],[c]=b.splice(p,1);b.splice(f,0,c),await n(b),q(null)},className:"rounded-xl bg-primary p-3 ring-1 ring-secondary active:scale-[0.99]",children:[(0,b.jsxs)("div",{className:"flex flex-col gap-3 md:flex-row md:items-center md:justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)(d.ButtonUtility,{"aria-label":"Drag to reorder",icon:i.Rows01,size:"sm"}),(0,b.jsxs)("div",{className:"flex min-w-0 flex-col",children:[(0,b.jsx)("p",{className:"text-md font-semibold text-primary",children:c.title}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("p",{className:"text-sm text-tertiary truncate",children:c.description}),"custom"!==c.priceType&&(0,b.jsxs)("span",{className:"text-sm font-medium text-primary",children:["₹",r.format(c.price)]}),(0,b.jsx)("span",{className:"text-xs text-secondary",children:"fixed"===c.priceType?"fixed":"starting"===c.priceType?"starting":"custom"})]})]})]}),(0,b.jsxs)("div",{className:"hidden md:flex items-center gap-2",children:[(0,b.jsx)(e.Toggle,{slim:!0,size:"md",isSelected:c.visible,onChange:a=>o(f,a),"aria-label":`Show ${c.title} on profile`}),(0,b.jsx)(d.ButtonUtility,{"aria-label":"Edit",icon:k.Edit01,size:"sm",onClick:()=>g(f)}),(0,b.jsx)(d.ButtonUtility,{"aria-label":"Delete",icon:j.Trash01,size:"sm",onClick:()=>m(f)})]})]}),(0,b.jsxs)("div",{className:"mt-2 flex md:hidden items-center gap-2 justify-end",children:[(0,b.jsx)(e.Toggle,{slim:!0,size:"md",isSelected:c.visible,onChange:a=>o(f,a),"aria-label":`Show ${c.title} on profile`}),(0,b.jsx)(d.ButtonUtility,{"aria-label":"Edit",icon:k.Edit01,size:"sm",onClick:()=>g(f)}),(0,b.jsx)(d.ButtonUtility,{"aria-label":"Delete",icon:j.Trash01,size:"sm",onClick:()=>m(f)})]})]},c.id))})})})};a.s(["default",()=>r])}];

//# sourceMappingURL=src_app_admin_offers_page_tsx_e2cae599._.js.map