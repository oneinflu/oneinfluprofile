module.exports=[49436,a=>{"use strict";var b=a.i(87924),c=a.i(52507),d=a.i(86762),e=a.i(6747),f=a.i(37819),g=a.i(15009),h=a.i(98275),i=a.i(36595),j=a.i(33210),k=a.i(53343),l=a.i(17600),m=a.i(13445),n=a.i(72131),o=a.i(4197),p=a.i(54708),q=a.i(61240);function r(){let{token:a,user:d}=(0,q.useAuth)(),[f,l]=(0,n.useState)([]),[m,r]=(0,n.useState)(!1),[s,u]=(0,n.useState)(null),[v,w]=(0,n.useState)(!1),[x,y]=(0,n.useState)(null),[z,A]=(0,n.useState)(!1),[B,C]=(0,n.useState)(0),[D,E]=(0,n.useState)({contentType:"image",fileUrl:void 0,file:null,externalUrl:"",title:"",brand:"",description:"",platform:"instagram",visible:!0,pinned:!1}),F=(0,n.useRef)(null);(0,n.useEffect)(()=>{let b=!0;return(async()=>{try{if(!d?.username)return;let c=await p.api.get(`/users/${d.username}/portfolio`,{token:a});if(!b)return;l((c.data?.items||[]).map(a=>({id:String(a._id||a.id),title:a.title,brand:a.brand||void 0,platform:a.platform||"website",thumbnail:a.fileUrl||void 0,visible:!!a.visible,description:a.description||void 0,contentType:a.contentType||void 0,externalUrl:a.externalUrl||void 0,pinned:!!a.pinned})))}catch{}})(),()=>{b=!1}},[d?.username,a]);let G=()=>{u(null),E({contentType:"image",fileUrl:void 0,file:null,externalUrl:"",title:"",brand:"",description:"",platform:"instagram",visible:!0,pinned:!1}),r(!0)},H=async()=>{if(D.title.trim())try{if(!d?.username||!a)throw Error("unauthorized");if(null===s){let b;if(D.file){let c=new FormData;c.append("file",D.file),c.append("contentType",D.contentType),c.append("externalUrl",D.externalUrl?.trim()||""),c.append("title",D.title.trim()),c.append("brand",D.brand?.trim()||""),c.append("description",(D.description||"").slice(0,120)),c.append("platform",D.platform),c.append("visible",String(D.visible)),c.append("pinned",String(D.pinned||!1));let e=`https://newyearbackendcode-zrp62.ondigitalocean.app//users/${d.username}/portfolio`,f=await fetch(e,{method:"POST",headers:{Authorization:`Bearer ${a}`},body:c}),g=await f.json().catch(()=>({}));if(!f.ok){if(g?.message==="storage_limit_reached"||413===f.status)return void A(!0);throw Error(g?.message||`HTTP ${f.status}`)}b=g.data?.item}else b=(await p.api.post(`/users/${d.username}/portfolio`,{contentType:D.contentType,fileUrl:D.fileUrl||null,externalUrl:D.externalUrl?.trim()||null,title:D.title.trim(),brand:D.brand?.trim()||null,description:(D.description||"").slice(0,120),platform:D.platform,visible:D.visible,pinned:D.pinned||!1},{token:a})).data.item;let c={id:b.id,title:b.title,brand:b.brand||void 0,platform:b.platform,thumbnail:b.thumbnail||b.fileUrl||void 0,visible:b.visible,description:b.description||void 0,contentType:b.contentType||void 0,externalUrl:b.externalUrl||void 0,pinned:b.pinned||!1};l(a=>[c,...a]),C(a=>a+1)}else{let b,c=f[s].id;if(D.file){let e=new FormData;e.append("file",D.file),e.append("contentType",D.contentType),e.append("externalUrl",D.externalUrl?.trim()||""),e.append("title",D.title.trim()),e.append("brand",D.brand?.trim()||""),e.append("description",(D.description||"").slice(0,120)),e.append("platform",D.platform),e.append("visible",String(D.visible)),e.append("pinned",String(D.pinned||!1));let f=`https://newyearbackendcode-zrp62.ondigitalocean.app//users/${d.username}/portfolio/${c}`,g=await fetch(f,{method:"PATCH",headers:{Authorization:`Bearer ${a}`},body:e}),h=await g.json().catch(()=>({}));if(!g.ok){if(h?.message==="storage_limit_reached"||413===g.status)return void A(!0);throw Error(h?.message||`HTTP ${g.status}`)}b=h.data?.item}else b=(await p.api.patch(`/users/${d.username}/portfolio/${c}`,{contentType:D.contentType,fileUrl:D.fileUrl||null,externalUrl:D.externalUrl?.trim()||null,title:D.title.trim(),brand:D.brand?.trim()||null,description:(D.description||"").slice(0,120),platform:D.platform,visible:D.visible,pinned:D.pinned||!1},{token:a})).data.item;let e={id:b.id,title:b.title,brand:b.brand||void 0,platform:b.platform,thumbnail:b.thumbnail||b.fileUrl||void 0,visible:b.visible,description:b.description||void 0,contentType:b.contentType||void 0,externalUrl:b.externalUrl||void 0,pinned:b.pinned||!1};l(a=>a.map((a,b)=>b===s?e:a)),C(a=>a+1)}}catch{}finally{r(!1)}};return(0,b.jsxs)("section",{className:"flex min-h-screen flex-col lg:pl-[300px]",children:[(0,b.jsx)("div",{className:"sticky top-0 z-10 px-4 md:px-8 pt-6 pb-4",children:(0,b.jsx)("div",{className:"w-full max-w-8xl",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,b.jsx)("h1",{className:"text-display-sm font-semibold text-primary",children:"My Portfolio"}),(0,b.jsx)("p",{className:"text-md text-tertiary",children:"Work visible on your public profile"})]}),(0,b.jsx)("div",{className:"flex items-center gap-2",children:(0,b.jsx)(c.Button,{size:"sm",onClick:G,children:"+ Add Work"})})]})})}),(0,b.jsx)("div",{className:"flex-1 min-h-0 overflow-y-auto overscroll-contain px-4 md:px-8 pt-8 pb-12",children:(0,b.jsxs)("div",{className:"w-full max-w-8xl grid gap-8 lg:grid-cols-[1fr_1px_360px]",children:[(0,b.jsx)("div",{className:"flex flex-col gap-6",children:(0,b.jsx)(t,{items:f,setItems:l,onEdit:a=>{let b=f[a];u(a),E({contentType:b.contentType||(b.externalUrl?"link":"image"),fileUrl:b.thumbnail,file:null,externalUrl:b.externalUrl||"",title:b.title,brand:b.brand||"",description:b.description||"",platform:b.platform,visible:b.visible,pinned:b.pinned||!1}),r(!0)},onAdd:G,onDelete:a=>{y(a),w(!0)},onToggle:async(b,c)=>{l(a=>a.map((a,d)=>d===b?{...a,visible:c}:a)),C(a=>a+1);try{if(!d?.username||!a)return;let e=f[b].id;await p.api.patch(`/users/${d.username}/portfolio/${e}`,{visible:c},{token:a})}catch{}}})}),(0,b.jsx)("div",{"aria-hidden":!0,className:"hidden lg:block self-stretch w-px bg-border-secondary"}),(0,b.jsx)("div",{className:"hidden lg:block",children:(0,b.jsx)("div",{className:"lg:sticky top-6",children:(0,b.jsx)(n.Suspense,{fallback:null,children:(0,b.jsx)(o.PhonePreview,{username:d?.username?`${d.username}?v=${B}`:void 0})})})})]})}),(0,b.jsxs)(j.DialogTrigger,{isOpen:v,onOpenChange:w,children:[(0,b.jsx)(c.Button,{slot:"trigger",className:"hidden",children:"Open"}),(0,b.jsx)(k.ModalOverlay,{isDismissable:!0,className:({isEntering:a,isExiting:b})=>`fixed inset-0 z-50 bg-overlay/40 backdrop-blur-sm ${a?"duration-150 ease-out animate-in fade-in":""} ${b?"duration-100 ease-in animate-out fade-out":""}`,children:({state:e})=>(0,b.jsx)(k.Modal,{className:"w-full h-dvh cursor-auto flex items-center justify-center p-4",children:(0,b.jsxs)(j.Dialog,{className:"w-full max-w-sm overflow-hidden rounded-2xl bg-primary shadow-xl ring-1 ring-secondary_alt focus:outline-hidden",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between border-b border-secondary px-4 py-3",children:[(0,b.jsx)("h2",{className:"text-lg font-semibold text-primary",children:"Delete work?"}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(c.Button,{size:"sm",color:"secondary",onClick:async()=>{if(null!==x)try{if(!d?.username||!a)throw Error("unauthorized");let b=f[x].id;await p.api.delete(`/users/${d.username}/portfolio/${b}`,{token:a}),l(a=>a.filter((a,b)=>b!==x)),C(a=>a+1)}catch{}finally{y(null),e.close()}},children:"Delete"}),(0,b.jsx)(c.Button,{size:"sm",onClick:()=>e.close(),children:"Cancel"})]})]}),(0,b.jsx)("div",{className:"px-4 py-4",children:(0,b.jsx)("p",{className:"text-sm text-tertiary",children:"This removes it from your profile immediately."})})]})})})]}),(0,b.jsxs)(j.DialogTrigger,{isOpen:z,onOpenChange:A,children:[(0,b.jsx)(c.Button,{slot:"trigger",className:"hidden",children:"Open"}),(0,b.jsx)(k.ModalOverlay,{isDismissable:!0,className:({isEntering:a,isExiting:b})=>`fixed inset-0 z-50 bg-overlay/40 backdrop-blur-sm ${a?"duration-150 ease-out animate-in fade-in":""} ${b?"duration-100 ease-in animate-out fade-out":""}`,children:({state:a})=>(0,b.jsx)(k.Modal,{className:"w-full h-dvh cursor-auto flex items-center justify-center p-4",children:(0,b.jsxs)(j.Dialog,{className:"w-full max-w-sm overflow-hidden rounded-2xl bg-primary shadow-xl ring-1 ring-secondary_alt focus:outline-hidden",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between border-b border-secondary px-4 py-3",children:[(0,b.jsx)("h2",{className:"text-lg font-semibold text-primary",children:"Upload limit reached"}),(0,b.jsx)("div",{className:"flex items-center gap-2",children:(0,b.jsx)(c.Button,{size:"sm",onClick:()=>a.close(),children:"Close"})})]}),(0,b.jsx)("div",{className:"px-4 py-4",children:(0,b.jsx)("p",{className:"text-sm text-tertiary",children:"Youâ€™ve reached your 15GB storage limit. Delete some files to upload new ones."})})]})})})]}),(0,b.jsxs)(j.DialogTrigger,{isOpen:m,onOpenChange:r,children:[(0,b.jsx)(c.Button,{slot:"trigger",className:"hidden",children:"Open"}),(0,b.jsx)(k.ModalOverlay,{isDismissable:!0,className:({isEntering:a,isExiting:b})=>`fixed inset-0 z-50 bg-overlay/40 backdrop-blur-sm ${a?"duration-150 ease-out animate-in fade-in":""} ${b?"duration-100 ease-in animate-out fade-out":""}`,children:({state:a})=>(0,b.jsx)(k.Modal,{className:"w-full cursor-auto",children:(0,b.jsxs)(j.Dialog,{className:"ml-auto h-dvh w-full max-w-md overflow-y-auto rounded-none bg-primary shadow-xl ring-1 ring-secondary_alt focus:outline-hidden",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between border-b border-secondary px-4 py-3",children:[(0,b.jsx)("h2",{className:"text-lg font-semibold text-primary",children:null===s?"Add Work":"Edit Work"}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(c.Button,{size:"sm",color:"secondary",onClick:H,children:"Save"}),(0,b.jsx)(c.Button,{size:"sm",onClick:()=>a.close(),children:"Cancel"})]})]}),(0,b.jsxs)("div",{className:"flex flex-col gap-6 px-4 py-4",children:[(0,b.jsxs)("div",{className:"flex min-w-0 flex-col gap-2",children:[(0,b.jsx)("h3",{className:"text-md font-semibold text-primary",children:"Content Type"}),(0,b.jsx)(i.Select,{size:"md",items:[{id:"image",label:"Image"},{id:"video",label:"Video / Reel"},{id:"link",label:"External link"}],selectedKey:D.contentType,onSelectionChange:a=>E(b=>({...b,contentType:String(a)})),children:a=>(0,b.jsx)(i.Select.Item,{id:a.id,children:a.label})})]}),(0,b.jsxs)("div",{className:"flex min-w-0 flex-col gap-2",children:[(0,b.jsx)("h3",{className:"text-md font-semibold text-primary",children:"Upload / Link"}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(c.Button,{size:"sm",color:"secondary",onClick:()=>F.current?.click(),children:"Upload file"}),(0,b.jsx)("input",{ref:F,type:"file",accept:"image"===D.contentType?"image/*":"video"===D.contentType?"video/*":"*/*",className:"hidden",onChange:a=>{let b=a.target.files?.[0];b&&E(a=>({...a,fileUrl:URL.createObjectURL(b),file:b}))}})]}),(0,b.jsx)(g.Input,{label:"Paste URL",placeholder:"Instagram / YouTube / Drive",value:D.externalUrl||"",onChange:a=>E(b=>({...b,externalUrl:a}))}),D.fileUrl&&(0,b.jsx)("div",{className:"mt-3 rounded-lg ring-1 ring-secondary overflow-hidden",children:"video"===D.contentType?(0,b.jsx)("video",{src:D.fileUrl,controls:!0,className:"w-full aspect-video bg-secondary"}):"image"===D.contentType?(0,b.jsx)("img",{src:D.fileUrl,alt:D.title||"Preview",className:"w-full aspect-video object-cover bg-secondary"}):null})]}),(0,b.jsxs)("div",{className:"flex min-w-0 flex-col gap-2",children:[(0,b.jsx)("h3",{className:"text-md font-semibold text-primary",children:"Details"}),(0,b.jsx)(g.Input,{label:"Title",placeholder:"e.g. Launch teaser",value:D.title,onChange:a=>E(b=>({...b,title:a}))}),(0,b.jsx)(g.Input,{label:"Brand name",placeholder:"optional",value:D.brand||"",onChange:a=>E(b=>({...b,brand:a}))}),(0,b.jsx)(h.TextArea,{label:"Short description",rows:3,value:D.description||"",onChange:a=>E(b=>({...b,description:a.slice(0,120)})),hint:`${Math.min(120,(D.description||"").length)}/120`})]}),(0,b.jsxs)("div",{className:"flex min-w-0 flex-col gap-2",children:[(0,b.jsx)("h3",{className:"text-md font-semibold text-primary",children:"Platform"}),(0,b.jsx)(i.Select,{size:"md",items:[{id:"instagram",label:"Instagram"},{id:"youtube",label:"YouTube"},{id:"tiktok",label:"TikTok"},{id:"x",label:"X"},{id:"threads",label:"Threads"},{id:"facebook",label:"Facebook"},{id:"linkedin",label:"LinkedIn"},{id:"telegram",label:"Telegram"},{id:"pinterest",label:"Pinterest"},{id:"website",label:"Website"}],selectedKey:D.platform,onSelectionChange:a=>E(b=>({...b,platform:String(a)})),children:a=>(0,b.jsx)(i.Select.Item,{id:a.id,children:a.label})})]}),(0,b.jsxs)("div",{className:"flex min-w-0 flex-col gap-2",children:[(0,b.jsx)("h3",{className:"text-md font-semibold text-primary",children:"Visibility"}),(0,b.jsx)(e.Toggle,{slim:!0,size:"md",isSelected:D.visible,onChange:a=>E(b=>({...b,visible:a})),"aria-label":"Show on profile"}),(0,b.jsx)(e.Toggle,{slim:!0,size:"md",isSelected:D.pinned||!1,onChange:a=>E(b=>({...b,pinned:a})),"aria-label":"Pin to top"})]})]})]})})})]})]})}let s=a=>({instagram:"/instagram.png",youtube:"/youtube.png",tiktok:"/tiktok.png",x:"/twitter.png",threads:"/threads.png",facebook:"/facebook.png",linkedin:"/linkedin.png",telegram:"/telegram.png",pinterest:"/pinterest.png",website:"/web.png"})[a]||"/web.png",t=({items:a,setItems:g,onEdit:h,onAdd:i,onDelete:o,onToggle:p})=>{let[q,r]=(0,n.useState)(null),[t,u]=(0,n.useState)(!1),[v,w]=(0,n.useState)(null),[x,y]=(0,n.useState)(!1);return 0===a.length?(0,b.jsx)("div",{className:"rounded-2xl bg-primary p-6 shadow-xs ring-1 ring-secondary_alt",children:(0,b.jsxs)("div",{className:"mx-auto max-w-md text-center",children:[(0,b.jsx)("h3",{className:"text-md font-semibold text-primary",children:"Your work builds trust"}),(0,b.jsx)("p",{className:"mt-1 text-sm text-tertiary",children:"Add past collaborations to convert brands faster."}),(0,b.jsx)("div",{className:"mt-4",children:(0,b.jsx)(c.Button,{size:"sm",color:"secondary",onClick:i,children:"+ Add your first work"})})]})}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("div",{className:"rounded-2xl bg-primary p-4 md:p-5 shadow-xs ring-1 ring-secondary_alt",children:(0,b.jsx)("div",{className:"grid grid-cols-1 gap-3 sm:grid-cols-2 lg:grid-cols-3",children:a.map((i,j)=>(0,b.jsxs)("div",{draggable:!0,onDragStart:()=>r(j),onDragOver:a=>a.preventDefault(),onDrop:()=>{if(null===q||q===j)return;let b=[...a],[c]=b.splice(q,1);b.splice(j,0,c),g(b),r(null)},className:"group rounded-xl ring-1 ring-secondary overflow-hidden",children:[(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsxs)("div",{className:"aspect-video bg-secondary flex items-center justify-center",children:["video"===i.contentType&&i.thumbnail?(0,b.jsx)("video",{src:i.thumbnail,className:"size-full object-cover pointer-events-none",muted:!0,playsInline:!0,preload:"metadata",controlsList:"nodownload noplaybackrate",disablePictureInPicture:!0,onContextMenu:a=>a.preventDefault()}):"image"===i.contentType&&i.thumbnail?(0,b.jsx)("img",{src:i.thumbnail,alt:i.title,className:"size-full object-cover select-none",draggable:!1,onContextMenu:a=>a.preventDefault()}):(0,b.jsx)("img",{src:s(i.platform),alt:i.platform,className:"h-12 w-12"}),(0,b.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,b.jsx)(c.Button,{size:"sm",color:"secondary",className:"px-3",onClick:()=>{w(i),y("video"===i.contentType),u(!0)},children:"video"===i.contentType?"Play":"View"})})]}),(0,b.jsxs)("div",{className:"absolute top-2 left-2 flex items-center gap-1",children:[j<3&&i.visible&&(0,b.jsx)(f.Badge,{color:"brand",size:"sm",children:"Top"}),i.pinned&&(0,b.jsx)(f.Badge,{color:"indigo",size:"sm",children:"Pinned"}),i.topWork&&(0,b.jsx)(f.Badge,{color:"brand",size:"sm",children:"Top work"}),i.sponsored&&(0,b.jsx)(f.Badge,{color:"warning",size:"sm",children:"Sponsored"})]}),(0,b.jsx)("div",{className:"absolute top-2 right-2",children:(0,b.jsx)("img",{src:s(i.platform),alt:i.platform,className:"h-6 w-6 rounded"})}),(0,b.jsx)("div",{className:"pointer-events-none absolute inset-0 bg-alpha-black opacity-0 transition duration-150 ease-in-out group-hover:opacity-5"}),(0,b.jsxs)("div",{className:"absolute inset-x-2 bottom-2 flex items-center justify-end gap-2 opacity-0 transition duration-150 ease-in-out group-hover:opacity-100",children:[(0,b.jsx)(e.Toggle,{slim:!0,size:"sm",isSelected:i.visible,onChange:a=>p(j,a),"aria-label":"Show on profile"}),(0,b.jsx)(d.ButtonUtility,{"aria-label":"Edit",icon:l.Edit01,size:"sm",onClick:()=>h(j)}),(0,b.jsx)(d.ButtonUtility,{"aria-label":"Delete",icon:m.Trash01,size:"sm",onClick:()=>o(j)})]})]}),(0,b.jsx)("div",{className:"flex items-center justify-between gap-3 p-3",children:(0,b.jsxs)("div",{className:"min-w-0",children:[(0,b.jsx)("p",{className:"text-md font-medium text-primary truncate",children:i.title}),i.brand&&(0,b.jsx)("p",{className:"text-sm text-tertiary truncate",children:i.brand||""})]})})]},i.id))})}),(0,b.jsxs)(j.DialogTrigger,{isOpen:t,onOpenChange:u,children:[(0,b.jsx)(c.Button,{slot:"trigger",className:"hidden",children:"Open"}),(0,b.jsx)(k.ModalOverlay,{isDismissable:!0,className:({isEntering:a,isExiting:b})=>`fixed inset-0 z-50 bg-overlay/50 backdrop-blur-md flex items-center justify-center p-4 ${a?"duration-150 ease-out animate-in fade-in":""} ${b?"duration-100 ease-in animate-out fade-out":""}`,children:({state:a})=>(0,b.jsx)(k.Modal,{className:"w-full cursor-auto",children:(0,b.jsxs)(j.Dialog,{"aria-label":"Work viewer",className:"mx-auto w-[min(92vw,420px)] overflow-hidden rounded-[2rem] bg-primary shadow-2xl ring-1 ring-secondary_alt focus:outline-hidden",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between border-b border-secondary px-5 py-4",children:[(0,b.jsx)("p",{className:"text-md font-semibold text-primary",children:v?.title||v?.brand||"Preview"}),(0,b.jsx)("div",{className:"flex items-center gap-2",children:(0,b.jsx)(c.Button,{size:"sm",onClick:()=>a.close(),children:"Back"})})]}),(0,b.jsx)("div",{className:"p-3",children:(0,b.jsx)("div",{className:"mx-auto aspect-[9/19] w-full rounded-[1.5rem] ring-1 ring-secondary_alt overflow-hidden bg-primary",children:v?"video"===v.contentType&&v.thumbnail?(0,b.jsx)("video",{src:v.thumbnail,className:"size-full object-cover",autoPlay:x,muted:!0,playsInline:!0,controlsList:"nodownload noplaybackrate",disablePictureInPicture:!0,onContextMenu:a=>a.preventDefault()}):"image"===v.contentType&&v.thumbnail?(0,b.jsx)("img",{src:v.thumbnail,alt:v.title||"Preview",className:"size-full object-cover select-none",draggable:!1,onContextMenu:a=>a.preventDefault()}):(0,b.jsx)("div",{className:"flex size-full items-center justify-center bg-secondary",children:(0,b.jsx)("img",{src:s(v.platform),alt:v.platform,className:"h-12 w-12"})}):null})})]})})})]})]})};a.s(["default",()=>r])}];

//# sourceMappingURL=src_app_admin_portfolio_page_tsx_734f5dc0._.js.map